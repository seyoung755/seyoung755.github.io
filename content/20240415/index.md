---
emoji: 
title: 클린 아키텍처 읽기 (1)
date: '2024-04-15 21:00:00'
author: seyeong
tags: clean-architecture
categories: book
---

## 클린 아키텍처 읽기 (1)

### 클린 아키텍처를 왜 읽을까?
- 회사에서 새로운 프로젝트를 진행하며 설계와 아키텍처에 대해 고민하는 시간이 많아졌다. 팀원들의 코드 리뷰와 질문을 통해 답을 찾아나가는 방법도 있지만 혼자만의
기준이 있는게 개발할 때 큰 도움이 될 것이라고 생각했다. 그래서 `좋은 구조란 무엇인가?` 라는 질문에 대해 좋은 답이 되는 책 중 하나인 `클린 아키텍처`를 읽기로
했다.

### 1. 설계와 아키텍처란?
회사에서 개발을 할 때도 `설계`와 `아키텍처`라는 말을 혼용해서 쓴다. 주로 설계라는 단어를 많이 쓰는데 이 책에서는 동일한 개념으로 보고 있다. 아키텍처 없는 설계 
또는 설계 없는 아키텍처는 말이 되지 않기 때문이다. 

__그럼 설계는 왜 중요한가?__
책에서는 어느 한 회사의 성장 곡선 사례를 보여준다. 회사가 성장하면서 직원 수는 늘지만 코드 생산성은 점점 수렴하는 모습을 보여준다. 
코드 생산성이 횡보하는 이유는 바로 코드 유지보수에 들어가는 코스트가 계속 증가했기 때문이다. 
실무를 하는 입장에서 많이 공감되는 부분이었다.

실제로 지금 코드를 짜면서도 가장 많이 나누는 말이 `지금 이렇게 좋은 구조를 짜놨지만 몇년 지나고 나서도 유지될 수 있을까?`였다.
이 말은 아키텍처나 설계가 중요하지 않다는 말이 아니라 유지보수를 하는 과정에서 쉽게 설계가 무너지고 유지보수가 어려운 코드가 되어간다는 의미이다.
즉, 아키텍처나 설계가 더 중요하다는 말이다. 

> 빨리 가는 유일한 방법은 제대로 가는 것이다.

라는 말이 나온다. 주로 시간에 쫓겨 개발하다보면 테스트, 좋은 구조에 대한 것들이 가장 먼저 외면받는 요소일 것이다.
하지만 책에서는 TDD를 했을 때 오히려 더 개발 진척도가 높았던 사례를 보여주며 이런 것을 신경쓰는 것이 시간 낭비가 아니라 가장 빠른길이라고 말한다.
또한, 아키텍처를 개선하는 방법이 다시 만드는 것이라고 생각하는 것을 경계하라고 한다.
무조건 새로 만든다고 좋아지는 것이 아니라 좋은 코드를 짜기 위해 충분한 고민을 해야만 개선할 수 있다고 말한다.


### 2. 두 가지 가치에 대한 이야기
소프트웨어는 두 가지 가치를 지닌다고 한다. 바로 `행위`와 `구조`이다. 
먼저 행위는 쉽게 말해 기능이다. 소프트웨어가 존재하는 이유는 어떤 기능이 동작함으로써 이익을 추구하는 것에 있다.
즉, 대부분의 개발은 이런 기능적 요구사항을 지키기 위한 행위이다. 그래서인지 대부분의 개발자들은 행위를 최우선의 가치로 두는 경향이 있는 것 같다.

두 번째 가치는 구조, 아키텍처이다. 소프트웨어라는 단어의 뜻은 soft(부드러운) + ware(제품) 라고 한다. 여기서 부드럽다는 뜻은 변경이 쉽다는 점이다.
만들어진대로 작동하고 변경하기 어려웠다면 hard + ware라고 작명이 되었을 거라고 얘기한다. 

즉, 소프트웨어가 software이려면 소프트웨어는 변경에 자유로워야한다. 소프트웨어는 운영되며 수많은 기능적 변경사항과 추가 기능을 요구받는다.
그 때마다 이런 사항을 쉽게 적용할 수 있어야 한다. 변경사항을 적용하는 데 드는 어려움은 변경되는 범위에 비례해야 하며 변경사항의 형태와는 관련이 없어야 한다.

소프트웨어 개발 비용의 증가를 결정짓는 요인이 이 변경되는 범위와 형태의 차이에 있다고 한다.
기획자는 항상 범위가 비슷한 사항을 들고 오지만, 개발자는 변경사항을 반영할 때마다 복잡도가 늘어나는 퍼즐판 위에서 다음 퍼즐을 맞추는 경험을 하게 된다.

__그 이유는 시스템의 형태와 요구사항의 형태가 서로 맞지 않기 때문이다.__
개발자는 사각형 마개를 동그란 구멍에 밀어 넣도록 강요받는 느낌을 받는다고 한다. 당연히 시스템의 아키텍처가 문제의 원인이고, 아키텍처가 특정한 형태에 종속될수록
새로운 기능을 이 구조에 맞추기 더 어려워진다. __따라서 아키텍처는 형태에 독립적이어야 하고, 그럴수록 더 실용적이다__

> 마지막 구절이 정말 와닿았다. 흔히 말하는 코드의 재사용성, 변경에 유연한 코드에 대한 내용을 잘 설명한 것 같다. 부디 이 책을 읽으며 이런 구조란 무엇일지에
대해 실마리를 얻어갔으면 좋겠다.

#### 그럼 누가 더 높은 가치인가?
당연히 기획자에게 이를 물어본다면 원하는 대로 동작하는 것이 제일 중요하다고 생각할 것이다.
하지만 개발자는 변경이 쉬운 프로그램을 만드는 것을 최우선 가치로 하는 것이 더 중요하다.
우리에게 기능 추가를 요구하는 기획자는 변경이 쉬운지, 어려운지에 대해 고려하는 책임이 없으며 단지 필요한 기능을 제안할 뿐이다.
`변경이 어려워서 반영하기 어렵다`라고 말한다면 `변경이 불가능한 상태에 처할 때까지 시스템을 방치했다`라는 말을 들을 수도 있다.

#### 아키텍처를 위해 투쟁하라
각 팀은 각자의 가치를 위해 투쟁하는 거처럼, 개발 팀은 더 중요한 가치인 아키텍처를 위해 투쟁해야 한다.
아키텍처가 후순위가 되면 시스템을 개발하는 비용이 더 많이 들고, 일부 또는 시스템 전체에 변경을 가하는 일이 현실적으로 불가능해진다.
이런 상황이 발생하도록 용납했다면, 그동안 충분히 투쟁하지 않았다는 증거가 된다.

> 개발자로서 일하며 단순히 기획사항을 만족하는 개발을 하는 것이 중요한가?라는 생각이 들 때가 있었는데 개발적인 아키텍처의 관점에서
기획자와 투쟁하는 것도 개발자로서의 책임이라는 걸 느꼈다. 이를 위해서는 평소 코드에 대한 아키텍처를 고민하고 어떤 요구사항이 아키텍처를 해치는 지에
대한 충분한 고민이 필요할 것 같다.
